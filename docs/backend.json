
{
  "entities": {
    "Company": {
      "title": "Company",
      "description": "Represents a single tenant (a transport company) on the platform.",
      "type": "object",
      "properties": {
        "companyId": {
          "type": "string",
          "description": "Unique identifier for the company, serves as the tenantId."
        },
        "name": {
          "type": "string",
          "description": "The legal name of the company."
        },
        "ownerId": {
          "type": "string",
          "description": "The Firebase UID of the user who owns the company."
        },
        "licenceType": {
          "type": "string",
          "enum": ["Trial", "Bronze", "Gold", "Platinum"],
          "description": "The subscription level of the company."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the company was created."
        }
      },
      "required": ["companyId", "name", "ownerId"]
    },
    "Branch": {
      "title": "Branch",
      "description": "Represents a branch office belonging to a company.",
      "type": "object",
      "properties": {
        "branchId": {
          "type": "string",
          "description": "Unique identifier for the branch within a company."
        },
        "name": {
          "type": "string",
          "description": "The name of the branch."
        },
        "address": {
          "type": "string",
          "description": "Physical address of the branch."
        },
        "city": {
          "type": "string"
        }
      },
      "required": ["branchId", "name"]
    },
    "Employee": {
      "title": "Employee",
      "description": "Represents an employee or staff member at a branch.",
      "type": "object",
      "properties": {
        "employeeId": {
          "type": "string",
          "description": "The Firebase UID of the employee."
        },
        "name": {
          "type": "string"
        },
        "role": {
          "type": "string",
          "enum": ["Manager", "Accountant", "Booking Clerk"]
        }
      },
      "required": ["employeeId", "name", "role"]
    },
    "Booking": {
        "title": "Booking",
        "description": "Represents a single consignment or booking. This is the new Lorry Receipt record.",
        "type": "object",
        "properties": {
            "trackingId": { "type": "string", "description": "Unique internal tracking ID, used as document ID." },
            "lrNumber": { "type": "string", "description": "The full formatted LR Number, e.g., ABC/NGP/2025-26/0001." },
            "companyCode": { "type": "string", "description": "Code of the company." },
            "branchCode": { "type": "string", "description": "Code of the branch." },
            "financialYear": { "type": "string", "description": "Financial year, e.g., '2025-26'." },
            "serialNumber": { "type": "integer", "description": "The sequential part of the LR number." },
            "lrOrigin": { "type": "string", "enum": ["SYSTEM_GENERATED", "MANUAL"], "description": "Indicates if the LR was system-generated or manually entered." },
            "status": { "type": "string" }
        },
        "required": ["trackingId", "lrNumber", "companyCode", "branchCode", "financialYear", "serialNumber", "lrOrigin"]
    },
    "Vehicle": {
        "title": "Vehicle",
        "description": "A vehicle belonging to a company.",
        "type": "object",
        "properties": {
            "vehicleId": {
                "type": "string"
            },
            "vehicleNo": {
                "type": "string"
            }
        },
        "required": ["vehicleId", "vehicleNo"]
    },
    "LrSequence": {
        "title": "LR Sequence Counter",
        "description": "Atomically stores the latest serial number for a given company, branch, and year.",
        "type": "object",
        "properties": {
            "currentSerial": { "type": "integer", "description": "The last used serial number." }
        },
        "required": ["currentSerial"]
    }
  },
  "auth": {
    "providers": ["password"]
  },
  "firestore": {
    "/companies/{companyId}": {
      "schema": {
        "$ref": "#/entities/Company"
      },
      "description": "Top-level collection for company tenant information."
    },
    "/companies/{companyId}/branches/{branchId}": {
      "schema": {
        "$ref": "#/entities/Branch"
      },
      "description": "Sub-collection for branches within a company."
    },
    "/companies/{companyId}/employees/{employeeId}": {
      "schema": {
        "$ref": "#/entities/Employee"
      },
      "description": "Sub-collection for employees within a company."
    },
    "/companies/{companyId}/lorryReceipts/{trackingId}": {
        "schema": {
            "$ref": "#/entities/Booking"
        },
        "description": "Stores all LR records for a company. The path ensures data is partitioned by company."
    },
    "/sequences/{companyId}/branches/{branchCode}/years/{financialYear}": {
        "schema": {
            "$ref": "#/entities/LrSequence"
        },
        "description": "Stores the auto-incrementing serial number counter for LRs. The document ID is 'lrSequence'."
    },
    "/companies/{companyId}/vehicles/{vehicleId}": {
        "schema": {
            "$ref": "#/entities/Vehicle"
        },
        "description": "Vehicles belonging to a specific company."
    }
  }
}
